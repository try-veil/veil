{
    order veil_handler before reverse_proxy
    admin 0.0.0.0:2019
    auto_https off  # Disable HTTPS for testing
    debug
}

:2020 {
    log {
        output stderr
        format console
        level DEBUG
    }

    # Global veil handler configuration with database path and subscription header
    veil_handler test.db X-Subscription-Key

    # Test Server Routes
    handle_path /api/v1/users/* {
        reverse_proxy http://localhost:8080
    }

    handle_path /api/v1/products/* {
        reverse_proxy http://localhost:8081
    }

    handle_path /api/v1/orders/* {
        reverse_proxy http://localhost:8082
    }

    # Management API route
    handle_path /veil/api/* {
        reverse_proxy http://localhost:2020
    }
}